<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>"Follow the mouse" animation experiment</title>
    <style media="screen">
      #follower {
        height: 64px;
        width: 300px;
        border: 2px solid lightgrey;
        background-color: lime;
      }
    </style>
  </head>
  <body>
    <div id="follower">

    </div>

    <script>
      var elem = document.getElementById('follower');

      var THRESHOLD = 300,
          offset = 0,
          mouseY = 0,
          MAX_SPEED = 50,
          sign = 1, // 1==positive; -1==negative
          speed = 0,
          y = 0;

      window.addEventListener("mousemove", update);
      var isRunning = false;

      function curve(offset, i) {
        let progress = Math.min(Math.abs(offset)/THRESHOLD, 1); // Number between 0 and 1

        //return Math.min(progress*progress+0.005, 1); // Shift it a bit so it ends faster (or at all)
        return Math.min(progress*(2-progress), 1);
      }

      function update (e) {
        mouseY = e.clientY;
        offset = y-mouseY;

        offset<0?sign=-1:sign=1;

        if (isRunning == false) {
            isRunning = true;
          requestAnimationFrame(animate);
        }

        function animate() {
          // Probably the easiest way of implementing such animation
          speed = MAX_SPEED*curve(offset);
          offset = Math.round(offset - speed * sign);

          if (offset==1 || offset==-1 || sign != Math.sign(offset))
            offset = 0;

          y = mouseY+offset;

          if (offset == 0) {
            isRunning = false;
            return;
          }
          requestAnimationFrame(animate);

          elem.setAttribute("style", `transform: translateY(${y}px)`)
        }
      }
    </script>
  </body>
</html>
